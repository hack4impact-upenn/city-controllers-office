{% extends 'layouts/base.html' %}
{% import 'macros/form_macros.html' as f %}

{% block content %}
{% set flashes = {
    'success': get_flashed_messages(category_filter=['form-success'])
  } %}

<div style="width: 70%; margin: auto;">
    <style>
        .paper {
            background-color: #f7f7f7;
            margin-top: 10px;
            padding: 30px;
            border-radius: 5px;
        }

        .theme-primary {
            color: #47688c;
        }

        .tag {
            display: inline-block;
            background-color: #c5cfd9;
            color: white;
            border-radius: 5px;
            margin: 2px;
            padding: 0px 15px;
            margin-right: 5px;
        }
    </style>
    <div class="ui grid" style="margin-top: 60px;">
        <div class="four wide column" style="margin-top: 70px">
            <a class="fluid ui labeled icon primary button" href="/search" style="font-family: Avenir; width: 80%; margin-bottom: 20px; text-align: left">
                <i class="left arrow icon"></i>
                Back to Search
            </a>
            {{ f.begin_form(results_csv_form, flashes) }}
            {{ f.render_form(results_csv_form) }}
            {{ f.end_form(results_csv_form) }}
            <br />
            <label class="label">Sort By:</label>
            {{ f.begin_form(high_to_low_form, flashes) }}
            {{ f.render_form(high_to_low_form) }}
            {{ f.end_form(high_to_low_form) }}
            <br />
            {{ f.begin_form(low_to_high_form, flashes) }}
            {{ f.render_form(low_to_high_form) }}
            {{ f.end_form(low_to_high_form) }}
            <br />
            {{ f.begin_form(abc, flashes) }}
            {{ f.render_form(abc) }}
            {{ f.end_form(abc) }}
            <br />
            {{ f.begin_form(cba, flashes) }}
            {{ f.render_form(cba) }}
            {{ f.end_form(cba) }}

            <!-- <div style="margin-top: 50px;">
                <div style="margin-top: 20px;">
                    <label style="display: block;">DEPARTMENT</label>
                    <select class="ui selection dropdown">
                        <option value="">ALL DEPARTMENTS</option>
                        <option value="1">Option A</option>
                        <option value="0">Option B</option>
                    </select>
                </div>
                <div style="margin-top: 20px;">
                    <label style="display: block;">CONTACT TYPE</label>
                    <select class="ui selection dropdown">
                        <option value="">ALL SERVICES</option>
                        <option value="1">Option A</option>
                        <option value="0">Option B</option>
                    </select>
                </div>
                <div style="margin-top: 20px;">
                    <label style="display: block;">VENDOR NAME</label>
                    <div class="ui input">
                        <input type="text" placeholder="Search..." style="width: 195px;">
                    </div>
                </div>
                <div style="margin-top: 20px;">
                    <label style="display: block;">KEYWORD</label>
                    <div class="ui input">
                        <input type="text" placeholder="Search..." style="width: 195px;">
                    </div>
                </div>
                <div style="margin-top: 20px;">
                    <label style="display: block;">CONTRACT NUMBER</label>
                    <div class="ui input">
                        <input type="text" placeholder="Search..." style="width: 195px;">
                    </div>
                </div>
            </div> -->

        </div>

        <div class="twelve wide column">
            <div>
                <h2>
                    {{ filtered|length }} Results
                </h2>
            </div>
            {% if filtered|length == 0 %}
            <br>
              <p style="font-size: 20px; font-weight: 600; text-transform: uppercase; color: #0f4d90">No Results Found</p>
            {% else %}
            {% for entry in filtered %}
            <div class="paper">
                <div class="ui grid">
                    <div class="eight wide column">
                        <h3 class="theme-primary">{{ entry.vendor }}</h3>
                        <p><i>ID: {{ entry.original_contract_id }}</i></p>
                    </div>
                    <div class="eight wide column">
                        <div style="line-height: 20px; ">
                            <div class="tag">TYPE</div>
                            <b>{{ entry.contract_structure_type }}</b>
                        </div>
                        <div style=" line-height: 20px;">
                            <div class="tag">DEPT</div><b>{{ entry.department_name }}</b>
                        </div>
                        <div style=" line-height: 20px;">
                          {% if entry.amt == 0 %}
                            <div class="tag">PAID</div><b> 100.00%</b>
                          {% else %}
                            <div class="tag">PAID</div><b> {{ (100*entry.tot_payments/entry.amt)|round(2) }}%</b>
                          {% endif %}
                        </div>
                    </div>
                    <div class="eight wide column">
                        <p><b>Total Payments:</b> {{ "${:,.2f}".format(entry.tot_payments) }}</p>
                        <p><b>Contact Amount:</b> {{ "${:,.2f}".format(entry.amt) }}</p>
                        <p style="font-weight: 600; text-transform: uppercase; color: #0f4d90">Profit Status: {{ entry.profit_status }} </p>
                    </div>
                    <div class="eight wide column">
                        <p><b>Description:</b> {{ entry.short_desc }} </p>
                        <p><b>Contract Term:</b> {{ entry.start_dt.strftime("%m-%d-%Y") }} to {{ entry.end_dt.strftime("%m-%d-%Y") }} </p>
                        <p style="font-weight: 600; text-transform: uppercase; color: #0f4d90">Exempt Status: {{ entry.adv_or_exempt }}</p>
                    </div>
                </div>
            </div>
            {% endfor %}
            {% endif %}
        </div>

    </div>
</div>
</div>
{% endblock %}
